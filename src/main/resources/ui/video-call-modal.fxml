<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.layout.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.*?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.text.Text?>

<StackPane xmlns="http://javafx.com/javafx" xmlns:fx="http://javafx.com/fxml"
    fx:controller="org.example.peer_chat.ui.controllers.VideoCallModalController"
    stylesheets="@../css/video-call-modal.css"
    styleClass="call-root"
    prefWidth="900" prefHeight="600">

    <!-- Full-screen gradient background -->
    <BorderPane styleClass="call-background">

        <!-- Center content: remote video lÃ m ná»n + overlay avatar, name, timer, call type -->
        <center>
            <StackPane styleClass="remote-video-container" BorderPane.alignment="CENTER">
                <!-- Ná»n: video Ä‘á»‘i phÆ°Æ¡ng -->
                <ImageView fx:id="remoteVideoFeed" preserveRatio="true" fitWidth="800"
                    fitHeight="400" />

                <!-- Overlay: giao diá»‡n cÅ© á»Ÿ giá»¯a -->
                <VBox alignment="CENTER" spacing="16">
                    <!-- Avatar of the contact -->
                    <Label fx:id="contactAvatar" text="ðŸ“¹" styleClass="call-avatar" />

                    <!-- Contact Name -->
                    <Label fx:id="contactName" text="Nguyá»…n VÄƒn A" styleClass="call-name" />

                    <!-- Call duration -->
                    <HBox alignment="CENTER">
                        <Label fx:id="callDurationWrapper" text="">
                            <graphic>
                                <Label>
                                    <graphic>
                                        <Text fx:id="callDuration" text="00:00"
                                            styleClass="call-duration-text" />
                                    </graphic>
                                </Label>
                            </graphic>
                        </Label>
                    </HBox>

                    <!-- Call Type (voice or video) -->
                    <HBox alignment="CENTER">
                        <Label fx:id="callTypePill" styleClass="call-type-pill">
                            <graphic>
                                <Text fx:id="callTypeLabel" text="Cuá»™c gá»i video ðŸ“¹" />
                            </graphic>
                        </Label>
                    </HBox>
                </VBox>
            </StackPane>
        </center>

        <!-- Bottom area: call controls -->
        <bottom>
            <VBox alignment="CENTER" spacing="16">
                <padding>
                    <Insets top="20" right="0" bottom="30" left="0" />
                </padding>

                <!-- Accept / Reject buttons for incoming calls -->
                <HBox alignment="CENTER" spacing="30" visible="false" managed="false">
                    <Button fx:id="acceptButton" text="âœ“ Cháº¥p nháº­n" onAction="#onAcceptCall"
                        styleClass="call-btn call-btn-accept" />
                    <Button fx:id="rejectButton" text="âœ• Há»§y" onAction="#onRejectCall"
                        styleClass="call-btn call-btn-reject" />
                </HBox>

                <!-- In-call controls (shown during an active call) -->
                <HBox alignment="CENTER" spacing="20" styleClass="call-controls">
                    <Button fx:id="muteButton" text="ðŸ”Š" onAction="#onToggleMute"
                        styleClass="call-btn call-btn-mute" />
                    <Button fx:id="videoButton" text="ðŸ“·" onAction="#onToggleVideo"
                        styleClass="call-btn call-btn-video" />
                    <Button fx:id="shareScreenButton" text="ðŸ–¥"
                        onAction="#onToggleScreenSharing" styleClass="call-btn call-btn-screen" />
                    <Button fx:id="endCallButton" text="ðŸ“µ" onAction="#onEndCall"
                        styleClass="call-btn call-btn-end" />
                </HBox>
            </VBox>
        </bottom>

        <!-- Top area: local video preview on the right -->
        <top>
            <HBox alignment="TOP_RIGHT">
                <padding>
                    <Insets top="16" right="20" bottom="0" left="0" />
                </padding>
                <StackPane fx:id="localVideoContainer" styleClass="local-video-container">
                    <ImageView fx:id="localVideoFeed" fitWidth="200" fitHeight="130" />
                    <Label text="Camera cá»§a báº¡n ðŸ“·" styleClass="local-video-label"
                        StackPane.alignment="BOTTOM_CENTER" style="-fx-padding: 5;" />
                </StackPane>
            </HBox>
        </top>

    </BorderPane>
</StackPane>