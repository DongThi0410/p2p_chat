<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.layout.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.*?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.text.Text?>

<StackPane xmlns="http://javafx.com/javafx" xmlns:fx="http://javafx.com/fxml"
    fx:controller="org.example.peer_chat.ui.controllers.VideoCallModalController"
    stylesheets="@../css/video-call-modal.css"
    styleClass="call-root">

    <!-- Full-screen gradient background -->
    <BorderPane styleClass="call-background">

        <!-- Center content: remote video lÃ m ná»n + overlay avatar, name, timer, call type -->
        <center>
            <StackPane styleClass="remote-video-container" BorderPane.alignment="CENTER">
                <!-- Ná»n: video Ä‘á»‘i phÆ°Æ¡ng -->
                <!-- Video fit háº§u háº¿t pháº§n ná»n xanh á»Ÿ giá»¯a -->
                <ImageView fx:id="remoteVideoFeed" preserveRatio="true" fitWidth="880"
                    fitHeight="460" />

                <!-- Overlay: giao diá»‡n cÅ© á»Ÿ giá»¯a -->
                <VBox alignment="CENTER" spacing="16">
                    <!-- Avatar of the contact -->
                    <Label fx:id="contactAvatar" text="ðŸ°" styleClass="call-avatar" />

                    <!-- Contact Name -->
                    <Label fx:id="contactName" text="Nguyá»…n VÄƒn A" styleClass="call-name" />

                    <!-- Call duration -->
                    <HBox alignment="CENTER">
                        <Label fx:id="callDurationWrapper" text="">
                            <graphic>
                                <Label>
                                    <graphic>
                                        <Text fx:id="callDuration" text="00:00"
                                            styleClass="call-duration-text" />
                                    </graphic>
                                </Label>
                            </graphic>
                        </Label>
                    </HBox>

                    <!-- Call Type (voice or video) -->
                    <HBox alignment="CENTER">
                        <Label fx:id="callTypePill" styleClass="call-type-pill">
                            <graphic>
                                <Text fx:id="callTypeLabel" text="Cuá»™c gá»i video ðŸ“¹" />
                            </graphic>
                        </Label>
                    </HBox>
                </VBox>
            </StackPane>
        </center>

        <!-- Top area: controls centered + local video preview on the right -->
        <top>
            <BorderPane BorderPane.alignment="TOP_CENTER">
                <padding>
                    <Insets top="16" right="20" bottom="0" left="20" />
                </padding>

                <!-- Centered call controls -->
                <center>
                    <HBox alignment="CENTER" spacing="18" styleClass="call-controls">

                        <!-- Accept / Reject buttons for incoming calls -->
                        <Button fx:id="acceptButton" text="Cháº¥p nháº­n" onAction="#onAcceptCall"
                            styleClass="call-btn call-btn-accept" visible="false" />
                        <Button fx:id="rejectButton" text="Há»§y" onAction="#onRejectCall"
                            styleClass="call-btn call-btn-reject" visible="false" />

                        <!-- In-call controls (shown during an active call) -->
                        <Button fx:id="muteButton" text="ðŸ”ˆ" onAction="#onToggleMute"
                            styleClass="call-btn call-btn-mute" />
                        <Button fx:id="videoButton" text="ðŸ“¹" onAction="#onToggleVideo"
                            styleClass="call-btn call-btn-video" />
                        <Button fx:id="shareScreenButton" text="ðŸ–¥"
                            onAction="#onToggleScreenSharing" styleClass="call-btn call-btn-screen" />
                        <Button fx:id="endCallButton" text="âœ–" onAction="#onEndCall"
                            styleClass="call-btn call-btn-end" />
                    </HBox>
                </center>

                <!-- Local video preview pinned to the top-right -->
                <right>
                    <HBox alignment="TOP_RIGHT" BorderPane.alignment="TOP_RIGHT">
                        <StackPane fx:id="localVideoContainer" styleClass="local-video-container">
                            <ImageView fx:id="localVideoFeed" fitWidth="220" fitHeight="150" />
                            <Label text="Camera cá»§a báº¡n ðŸ“·" styleClass="local-video-label" />
                        </StackPane>
                    </HBox>
                </right>
            </BorderPane>
        </top>

    </BorderPane>
</StackPane>